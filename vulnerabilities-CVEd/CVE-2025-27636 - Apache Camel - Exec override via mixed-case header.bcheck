metadata:
    language: v2-beta
    name: "[CVE-2025-27636] – Exec override via mixed-case header in Apache Camel"
    description: "This rule checks if the remote host is vulnerable to CVE-2025-27636 - Exec override via mixed-case header in Apache Camel"
    author: "Maxwell Francis (@xerodium)"
    tags: "CVE-2025-27636","Apache Camel","Camel","RCE"

given path then
  # Send a harmless probe that attempts to override the exec command to `echo`.
  send request called probe:
    method: "GET"
    headers:
      "CAmelExecCommandExecutable": "echo"
      "CAmelExecCommandArgs": "BURP-CAMEL-TEST"

  # If the response body contains our token, the override worked (vulnerable).
  if {"BURP-CAMEL-TEST"} in {probe.response.body} then
    report issue:
      name: "Apache Camel header injection (CVE-2025-27636) – Exec override via mixed-case header"
      severity: high
      confidence: firm
      remediation: "Upgrade Apache Camel to a fixed version (3.22.4, 4.8.5, or 4.10.2+). Block or normalize Camel-specific headers at ingress; disable or isolate the Exec component; and denylist mixed-case variants such as 'CAmelExecCommand*'. See Apache advisory for details."
      detail: "This endpoint appears vulnerable to CVE-2025-27636. Sending the mixed-case header 'CAmelExecCommandExecutable' with value 'echo' and args 'BURP-CAMEL-TEST' caused the response to include the probe token, indicating the Exec command was overridden.\n\nRequest (redacted):\n{probe.request}\n\nResponse excerpt:\n{truncate({probe.response.body}, 512)}"
  end if
