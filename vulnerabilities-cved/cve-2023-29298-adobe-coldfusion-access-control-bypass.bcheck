metadata:
    language: v1-beta
    name: "CVE-2023-29298 Adobe ColdFusion Access Control Bypass"
    description: "Checks for CVE-2023-29298"
    author: "Ollie Whitehouse"
    tags: "CVE-2023-29298 CVE ColdFusion"

# Details of the vulnerability can be found in https://www.rapid7.com/blog/post/2023/07/11/cve-2023-29298-adobe-coldfusion-access-control-bypass/
define:
    potential_path =
        "//CFIDE/administrator/index.cfm"

given host then
    send request called check:
        method: "GET"
        path: {potential_path}

		# Checks that we get a 200 AND that the output we expect in the result
		if {check.response.status_code} is "200" and "ColdFusion" in {check.response.body} then
			report issue:
				severity: high
				confidence: certain
				detail: "Host is vulnerable to the access control bypass vulnerability CVE-2023-29298"
				remediation: "See Adobe's APSB23-40 Security Bulletin - CF2018 Update 17, CF2021 Update 7, and CF2023 GA build for patched version"
		end if
